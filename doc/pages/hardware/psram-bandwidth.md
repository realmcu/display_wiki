# PSRAM带宽需求

本章节介绍显示系统中PSRAM的带宽需求分析。

## 带宽计算基础

PSRAM带宽需求主要取决于以下因素：

- 显示分辨率
- 刷新率
- 色彩深度
- 图形处理需求

基本计算公式：

```
带宽 = 分辨率 × 刷新率 × 每像素字节数
```

## RGB接口屏幕带宽计算

### ARGB8888格式（32位色深）

每像素占用 **4字节**（Alpha + RGB各8位）

#### 自刷新场景（60 FPS）

假设分辨率为 **W × H**：

```
读带宽 = W × H × 4字节 × 60 FPS
```

**示例**（常见分辨率）：

| 分辨率 | 计算 | 带宽需求 |
|--------|------|----------|
| 480×480 | 480 × 480 × 4 × 60 | **55.3 MB/s** |
| 800×480 | 800 × 480 × 4 × 60 | **92.2 MB/s** |
| 1024×600 | 1024 × 600 × 4 × 60 | **147.5 MB/s** |

#### 内容更新场景（30 FPS）

GPU渲染新内容时需要：
- **读取**：读取旧帧缓冲（用于混合/覆盖）
- **写入**：写入新帧缓冲

```
读带宽 = W × H × 4字节 × 30 FPS
写带宽 = W × H × 4字节 × 30 FPS
总带宽 = 读带宽 + 写带宽
```

**示例**（常见分辨率）：

| 分辨率 | 读带宽 | 写带宽 | 总带宽 |
|--------|--------|--------|--------|
| 480×480 | 27.6 MB/s | 27.6 MB/s | **55.3 MB/s** |
| 800×480 | 46.1 MB/s | 46.1 MB/s | **92.2 MB/s** |
| 1024×600 | 73.7 MB/s | 73.7 MB/s | **147.5 MB/s** |

#### 混合场景（60 FPS自刷新 + 30 FPS更新）

实际应用中，显示控制器以60 FPS读取帧缓冲，同时GPU以30 FPS更新内容：

```
总带宽 = (W × H × 4 × 60) + (W × H × 4 × 30 × 2)
       = W × H × 4 × (60 + 60)
       = W × H × 4 × 120
```

**示例**（常见分辨率）：

| 分辨率 | 显示读取 | GPU读写 | 总带宽 |
|--------|----------|---------|--------|
| 480×480 | 55.3 MB/s | 55.3 MB/s | **110.6 MB/s** |
| 800×480 | 92.2 MB/s | 92.2 MB/s | **184.3 MB/s** |
| 1024×600 | 147.5 MB/s | 147.5 MB/s | **295.0 MB/s** |

## 优化建议

### 降低带宽需求

- **使用RGB565格式**：每像素2字节，带宽减半
- **局部刷新**：仅更新变化区域
- **降低刷新率**：非动画场景使用30 FPS
- **双缓冲优化**：减少不必要的读取

**注意**：实际带宽需预留20-30%余量，考虑系统其他模块的访问需求。

## 参考数据

以上计算基于理想情况，实际应用中还需考虑：
- DMA传输效率
- 缓存命中率
- 总线仲裁开销
- 其他外设的带宽占用
